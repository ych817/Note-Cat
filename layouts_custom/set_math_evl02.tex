\makeatletter
\def\RegistOprEvalTypeU#1Form#2{%
  \let\RegistOprEvalTypeU@opr=\relax%
  \ExpandArgs{c}\def{ev#2}{%
    \@ifnextchar [%
    {\UseName{ev#2@Yopt@}}
    {%
      \def\RegistOprEvalTypeU@opr{\UseName{#2}}%
      \UseName{ev#2@}
    }%
  }%
  \ExpandArgs{c}\def{ev#2@Yopt@}[##1]{%
    \@ifnextchar (%
    {\UseName{ev#2@Yopt@Yopt}{##1}}%
    {%
      \def\RegistOprEvalTypeU@opr{\UseName{#2}[{##1}]}%
      \UseName{ev#2@}
    }%
  }%
  \ExpandArgs{c}\DeclareDocumentCommand{ev#2@}{ e{.} tp }{
     \IfValueTF{##1}
    {\IfBooleanTF{##2}
    {\UseName{evU#1p}{\RegistOprEvalTypeU@opr}{##1}}%
    {\UseName{evU#1}{\RegistOprEvalTypeU@opr}{##1}}}
    {\RegistOprEvalTypeU@opr}
  }
}
\def\RegistOprEvalTypeB#1Form#2{%
  \ExpandArgs{c}\DeclareDocumentCommand{ev#2}{%
    +O{\UseName{opr#2defaultType}}%
    d()%
    e{.}%
    e{<}% 
    e{>}%
    tp%
    e{.}%
    tp%
  } {%
    \def\cmdout{evB#1}%
    \def\cmdopr{\UseName{#2}}%
    \IfValueT{##1}{\edef\cmdopr{\cmdopr[{##1}]}%
      \IfValueT{##2}{\edef\cmdopr{\cmdopr({##2})}}%
    }%
    \IfValueT{##4}{\edef\cmdout{\cmdout L}}%
    \IfValueT{##5}{\edef\cmdout{\cmdout R}}%
    \IfBooleanT{##6}{\edef\cmdout{\cmdout p}}%
    \IfValueT{##4}{\IfValueT{##7}{\edef\cmdout{\cmdout R}}}%
    \IfValueT{##5}{\IfValueT{##7}{\edef\cmdout{\cmdout L}}}%
    \IfBooleanT{##8}{\edef\cmdout{\cmdout p}}%
    \IfValueTF{##7}{%
    \IfValueTF{##3}{\ExpandArgs{nc}\UseName{\cmdout}{cmdopr}{##3}{##7}}{%
      \IfValueTF{##4}{\ExpandArgs{nc}\UseName{\cmdout}{cmdopr}{##4}{##7}}{%
      \IfValueTF{##5}{\ExpandArgs{nc}\UseName{\cmdout}{cmdopr}{##5}{##7}}{%
        \ERROR % \evB#1[ ]p.{\bojcn2}
      }%
      }%
    }%
    }{%
    \IfValueTF{##3}{\ExpandArgs{nc}\UseName{\cmdout}{cmdopr}{##3}}{%
      \IfValueTF{##4}{\ExpandArgs{nc}\UseName{\cmdout}{cmdopr}{##4}}{%
      \IfValueTF{##5}{\ExpandArgs{nc}\UseName{\cmdout}{cmdopr}{##5}}{%
        \UseName{cmdopr}%
      }%
      }%
    }%
    }%
  }%
}
\makeatother