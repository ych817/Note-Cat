\makeatletter
% ----- 运算符注册模板
\def\RegistOpr#1Type{
  \@ifnextchar A%
  {\RegistOpr@TypeA@{#1}}
  {\@ifnextchar B%
  {\RegistOpr@TypeB@{#1}}
  {\@ifnextchar D%
  {\RegistOpr@TypeD@{#1}}
  {\relax}}}
}
\def\RegistOpr@TypeA@#1ADflt#2Disp#3{
  \xpndaft\ncm\xpndaft{\csname #1\endcsname}[1][#2]{%
    \plr{\ensuremath{%
      \stackunder[0pt]{\stackon[0pt]{\plr{#3}}
      {}}
      {\text{\scriptsize\(\plr{##1}\)}}
    }}
  }
}
\def\RegistOpr@TypeB@#1BDflt#2{
  \xpndaft\ncm\xpndaft{\csname #1\endcsname}[1][#2]{%
    \plr{\ensuremath{%
      \xrightarrow[\text{\scriptsize\(\plr{##1}\)}]{}%
    }}
  }
}
\def\RegistOpr@TypeD@#1DDflt#2Disp#3{
  \xpndaft\ncm\xpndaft{\csname #1\endcsname}[1][#2]{%
    \plr{\ensuremath{%
      {}_{\scriptscriptstyle\plr{:##1}}^{}{#3}
    }}
  }
}

% \def\RegistOprFormTypeAName#1Disp#2Dflt#3{%
%   \xpndaft\newcommand\xpndaft{\csname #1\endcsname}[1][#3]{\plr{\ensuremath{
%     \stackunder[0pt]{\stackon[0pt]{\plr{#2}}
%     {}}
%     {\text{\scriptsize\(\plr{##1}\)}}
%   }}}
% }
% \def\RegistOprFormTypeBName#1Dflt#2{%
%   \xpndaft\newcommand\xpndaft{\csname #1\endcsname}[1][#2]{\plr{\ensuremath{%
%     \xrightarrow[\text{\scriptsize\(\plr{##1}\)}]{}%
%   }}}
% }
% \def\RegistOprFormTypeCName#1Disp#2DfltCat#3DfltIdx#4{%
%   \xpndaft\def\csname #1\endcsname{%
%     \@ifnextchar [%
%     {\csname #1@YCat@\endcsname}
%     {\csname #1@NCat@\endcsname{#3}}
%   }
%   \xpndaft\def\csname #1@NCat@\endcsname##1{%
%     \@ifnextchar (%
%     {\csname #1@NCat@YIdx\endcsname{##1}}
%     {\csname #1@NCat@NIdx\endcsname{##1}{#4}}
%   }
%   \xpndaft\def\csname #1@YCat@\endcsname[##1]{%
%     \@ifnextchar (%
%     {\csname #1@YCat@YIdx\endcsname{##1}}
%     {\csname #1@YCat@NIdx\endcsname{##1}{#4}}
%   }
%   \xpndaft\def\csname #1@NCat@NIdx\endcsname##1##2{%
%     \csname #1@Final\endcsname{##1}{##2}
%   }
%   \xpndaft\def\csname #1@NCat@YIdx\endcsname##1(##2){%
%     \csname #1@Final\endcsname{##1}{##2}
%   }
%   \xpndaft\def\csname #1@YCat@NIdx\endcsname##1##2{%
%     \csname #1@Final\endcsname{##1}{##2}
%   }
%   \xpndaft\def\csname #1@YCat@YIdx\endcsname##1(##2){%
%     \csname #1@Final\endcsname{##1}{##2}
%   }
%   \xpndaft\def\csname #1@Final\endcsname##1##2{\plr{\ensuremath{%
%     \stackunder[0pt]{\stackon[0pt]{\plr{#2}}
%     {}}
%     {\text{\scriptsize\(\plr{{##1}~{##2}}\)}}
%   }}}%
% }
% \def\RegistOprFormTypeDName#1Disp#2Dflt#3{%
%   \xpndaft\newcommand\xpndaft{\csname #1\endcsname}[1][#3]{\plr{\ensuremath{%
%     {}_{\scriptscriptstyle\plr{:##1}}^{}{#2}
%   }}}
% }
\makeatother